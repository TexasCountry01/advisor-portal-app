{% extends 'base.html' %}

{% block title %}Federal Fact Finder Form{% endblock %}

{% block extra_css %}
<style>
    .fact-finder-form {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    
    .form-header {
        border-bottom: 3px solid #0066cc;
        padding-bottom: 20px;
        margin-bottom: 30px;
    }
    
    .form-header h1 {
        color: #0066cc;
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 5px;
    }
    
    .form-header .subtitle {
        font-size: 14px;
        color: #666;
        margin-bottom: 15px;
    }
    
    .header-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
        gap: 10px;
    }
    
    .header-info {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }
    
    .info-field {
        background: #f8f9fa;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 14px;
    }
    
    .info-field label {
        font-weight: 600;
        margin-right: 5px;
    }
    
    .form-section {
        margin-bottom: 35px;
        padding: 25px;
        background: #f8f9fa;
    }
    
    .section-title {
        font-size: 18px;
        font-weight: bold;
        color: #0066cc;
        margin-bottom: 20px;
        text-transform: uppercase;
    }
    
    .form-row {
        margin-bottom: 15px;
    }
    
    .form-label {
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
    }
    
    .form-control, .form-select {
        border: 1px solid #ced4da;
        border-radius: 4px;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #0066cc;
        box-shadow: 0 0 0 0.2rem rgba(0,102,204,0.25);
    }
    
    .checkbox-group label {
        font-weight: normal;
    }
    
    .draft-banner {
        background: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 4px;
        padding: 15px 20px;
        margin-bottom: 20px;
        display: none;
    }
    
    .draft-banner.show {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .draft-banner-text {
        flex: 1;
        margin-right: 15px;
    }
    
    .draft-banner-actions {
        display: flex;
        gap: 10px;
    }
    
    .required-field::after {
        content: " *";
        color: #dc3545;
    }
    
    .help-text {
        font-size: 12px;
        color: #6c757d;
        font-style: italic;
    }
    
    .submit-section {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 2px solid #dee2e6;
    }
    
    .document-upload-section {
        background: #fff3cd;
        border: 2px solid #ffc107;
        padding: 25px;
        border-radius: 8px;
        margin-bottom: 30px;
    }
    
    .document-upload-section h3 {
        color: #856404;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
    }
    
    .file-list {
        list-style: none;
        padding: 0;
    }
    
    .file-list-item {
        background: white;
        padding: 10px;
        margin-bottom: 8px;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .btn-action {
        min-width: 140px;
    }
    
    @media print {
        .fact-finder-form {
            box-shadow: none;
        }
        .submit-section {
            display: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="fact-finder-form">
        <form method="post" id="factFinderForm" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="hidden" name="action" id="formAction" value="submit">
            
            <!-- FORM HEADER -->
            <div style="background: #f8f9fa; border: 1px solid #dee2e6; padding: 20px; margin-bottom: 20px;">
                <div class="text-center mb-3">
                    <small>*** When submitting via email, use this subject line: <strong>( )</strong> (this field auto-fills from info entered below) ***</small>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <h2 style="font-weight: bold; font-size: 20px; margin-bottom: 10px;">ProFeds Federal Fact Finder – 2025 v1</h2>
                        <p style="font-size: 12px; margin-bottom: 5px;">Along with the FFF, include pay stub, TSP & SS statements</p>
                        <p style="font-size: 12px; margin-bottom: 5px;">Email to <strong>Reports@ProFeds.com</strong> / Fax to <strong>866-779-9921</strong></p>
                        <p style="color: red; font-weight: bold; font-size: 11px; margin-bottom: 15px;">MEMBER USE ONLY - NOT FOR DISTRIBUTION TO PUBLIC</p>
                        
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-primary" onclick="clearForm()" style="background: #4472c4; border: none; font-weight: bold;">
                                CLEAR FORM
                            </button>
                            <button type="button" class="btn btn-success" onclick="saveDraft()" style="background: #70ad47; border: none; font-weight: bold;">
                                SAVE FILE
                            </button>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="row mb-2">
                            <div class="col-md-4">
                                <label class="form-label mb-0" style="font-weight: bold; font-size: 13px;">Member Name:</label>
                            </div>
                            <div class="col-md-5">
                                <input type="text" name="member_name" class="form-control form-control-sm" value="{{ member_name }}" readonly style="background-color: #f8f9fa;">
                            </div>
                            <div class="col-md-3">
                                <div style="border: 1px solid #dee2e6; background: white; padding: 5px; text-align: center;">
                                    <div style="font-weight: bold; font-size: 10px; margin-bottom: 3px;">Workshop</div>
                                    <div style="font-weight: bold; font-size: 10px;">Code</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-4">
                                <label class="form-label mb-0" style="font-weight: bold; font-size: 13px;">Date submitted:</label>
                            </div>
                            <div class="col-md-5">
                                <input type="date" name="date_submitted" class="form-control form-control-sm" value="{% now 'Y-m-d' %}">
                            </div>
                            <div class="col-md-3">
                                <input type="text" name="workshop_code" class="form-control form-control-sm text-center" value="{{ workshop_code }}" readonly style="font-size: 11px; background-color: #f8f9fa;">
                            </div>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-4">
                                <label class="form-label mb-0" style="font-weight: bold; font-size: 13px;">Requested due date:</label>
                            </div>
                            <div class="col-md-8">
                                <input type="date" name="requested_due_date" class="form-control form-control-sm">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Draft Restore Banner -->
            <div id="draftBanner" class="draft-banner">
                <div class="draft-banner-text">
                    <i class="bi bi-info-circle"></i>
                    <strong>Draft Found:</strong> <span id="draftDate"></span>
                </div>
                <div class="draft-banner-actions">
                    <button type="button" class="btn btn-sm btn-primary" onclick="restoreDraftData()">
                        <i class="bi bi-arrow-counterclockwise"></i> Restore Draft
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-secondary" onclick="dismissDraft()">
                        Dismiss
                    </button>
                </div>
            </div>
            
            <!-- BASIC INFORMATION -->
            <div class="form-section">
                <h2 class="section-title" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">BASIC INFORMATION</h2>
                
                <div class="row form-row mb-3">
                    <div class="col-md-7">
                        <label class="form-label" style="font-size: 12px;">Employee's name:</label>
                        <input type="text" name="employee_name" id="employee_name" class="form-control" required>
                    </div>
                    <div class="col-md-5">
                        <label class="form-label" style="font-size: 12px;">Date of birth:</label>
                        <input type="date" name="employee_dob" id="employee_dob" class="form-control" min="1900-01-01" max="{% now 'Y-m-d' %}" required>
                    </div>
                </div>
                
                <div class="row form-row mb-3 align-items-end">
                    <div class="col-md-5">
                        <label class="form-label" style="font-size: 12px;">Spouse's name:</label>
                        <input type="text" name="spouse_name" class="form-control">
                    </div>
                    <div class="col-md-2 text-center">
                        <div class="form-check d-inline-block mb-2">
                            <input class="form-check-input" type="checkbox" name="spouse_fed_emp" id="spouse_fed_emp">
                            <label class="form-check-label" for="spouse_fed_emp" style="font-size: 12px;">
                                Fed Emp?
                            </label>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <label class="form-label" style="font-size: 12px;">Date of birth:</label>
                        <input type="date" name="spouse_dob" class="form-control" min="1900-01-01" max="{% now 'Y-m-d' %}">
                    </div>
                </div>
                
                <div class="row form-row">
                    <div class="col-md-4">
                        <label class="form-label" style="font-size: 12px;">Address:</label>
                        <input type="text" name="address" class="form-control">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label" style="font-size: 12px;">City</label>
                        <input type="text" name="city" class="form-control">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label" style="font-size: 12px;">St</label>
                        <input type="text" name="state" class="form-control" maxlength="2">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label" style="font-size: 12px;">Zip</label>
                        <input type="text" name="zip" class="form-control" maxlength="10">
                    </div>
                </div>
            </div>

            <!-- RETIREMENT SYSTEM and EMPLOYEE TYPE -->
            <div class="row">
                <div class="col-md-6">
                    <!-- RETIREMENT SYSTEM -->
                    <div class="form-section" style="border: 2px solid #d9d9d9; padding: 25px; margin-bottom: 20px; height: 100%;">
                        <h2 style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px; text-align: center; font-weight: bold; font-size: 14px;">RETIREMENT SYSTEM</h2>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="retirement_system" value="CSRS" id="csrs">
                            <label class="form-check-label" for="csrs" style="font-size: 12px;">
                                CSRS
                            </label>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="retirement_system" value="CSRS Offset" id="csrs_offset">
                                    <label class="form-check-label" for="csrs_offset" style="font-size: 12px;">
                                        CSRS Offset
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">Offset date:</label>
                                <input type="date" name="csrs_offset_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="retirement_system" value="FERS" id="fers">
                            <label class="form-check-label" for="fers" style="font-size: 12px;">
                                FERS
                            </label>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="retirement_system" value="FERS Transfer" id="fers_transfer">
                                    <label class="form-check-label" for="fers_transfer" style="font-size: 12px;">
                                        FERS Transfer
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">Transfer date:</label>
                                <input type="date" name="fers_transfer_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <h3 style="background: #d9d9d9; padding: 8px; margin: 20px -25px 15px -25px; text-align: center; font-size: 14px; font-weight: bold;">RETIREMENT TYPE</h3>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="retirement_type" value="Regular" id="ret_regular">
                            <label class="form-check-label" for="ret_regular" style="font-size: 12px;">
                                Regular (fully-eligible or MRA+10 scenario)
                            </label>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-7">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="retirement_type" value="Optional" id="ret_optional">
                                    <label class="form-check-label" for="ret_optional" style="font-size: 12px;">
                                        Optional (early out)
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <label class="form-label" style="font-size: 11px;">Offer date:</label>
                                <input type="date" name="optional_offer_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="retirement_type" value="Deferred" id="ret_deferred">
                            <label class="form-check-label" for="ret_deferred" style="font-size: 12px;">
                                Deferred (too young, but vested to get later)
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="retirement_type" value="Disability" id="ret_disability">
                            <label class="form-check-label" for="ret_disability" style="font-size: 12px;">
                                Disability (not already fully-eligible & must qualify)
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <!-- EMPLOYEE TYPE -->
                    <div class="form-section" style="border: 2px solid #d9d9d9; padding: 25px; margin-bottom: 20px; height: 100%;">
                        <h2 style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px; text-align: center; font-weight: bold; font-size: 14px;">EMPLOYEE TYPE</h2>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="employee_type" value="Regular" id="emp_regular">
                            <label class="form-check-label" for="emp_regular" style="font-size: 12px;">
                                Regular
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="employee_type" value="Regular - Postal Worker" id="emp_postal">
                            <label class="form-check-label" for="emp_postal" style="font-size: 12px;">
                                Regular – Postal Worker
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="employee_type" value="Regular - Military Reserve Technician" id="emp_military">
                            <label class="form-check-label" for="emp_military" style="font-size: 12px;">
                                Regular – Military Reserve Technician
                            </label>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="employee_type" value="Law Enforcement" id="emp_leo">
                                    <label class="form-check-label" for="emp_leo" style="font-size: 12px;">
                                        Law Enforcement
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">LEO start date:</label>
                                <input type="date" name="leo_start_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check mb-1">
                                <input class="form-check-input" type="radio" name="employee_type" value="Customs & Border Protection Officer" id="emp_cbpo">
                                <label class="form-check-label" for="emp_cbpo" style="font-size: 12px;">
                                    Customs & Border Protection Officer
                                </label>
                            </div>
                            <div class="ps-4">
                                <small class="text-muted" style="font-size: 10px;">Were you a CBPO on 7/6/2008 when the position became law enforcement?</small>
                                <div class="d-flex gap-3 mt-1">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="cbpo_coverage" value="Yes" id="cbpo_yes">
                                        <label class="form-check-label" for="cbpo_yes" style="font-size: 11px;">
                                            Yes
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="cbpo_coverage" value="No" id="cbpo_no">
                                        <label class="form-check-label" for="cbpo_no" style="font-size: 11px;">
                                            No
                                        </label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="cbpo_coverage" value="Unsure" id="cbpo_unsure">
                                        <label class="form-check-label" for="cbpo_unsure" style="font-size: 11px;">
                                            Unsure
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="employee_type" value="Firefighter" id="emp_firefighter">
                                    <label class="form-check-label" for="emp_firefighter" style="font-size: 12px;">
                                        Firefighter
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">FF start date:</label>
                                <input type="date" name="ff_start_date" id="ff_start_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="employee_type" value="Air Traffic Controller" id="emp_atc">
                                    <label class="form-check-label" for="emp_atc" style="font-size: 12px;">
                                        Air Traffic Controller
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">ATC start date:</label>
                                <input type="date" name="atc_start_date" id="atc_start_date" class="form-control form-control-sm">
                            </div>
                        </div>
                        
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="employee_type" value="Foreign Service" id="emp_foreign">
                                    <label class="form-check-label" for="emp_foreign" style="font-size: 12px;">
                                        Foreign Service
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label" style="font-size: 11px;">FS start date:</label>
                                <input type="date" name="fs_start_date" id="fs_start_date" class="form-control form-control-sm">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RETIREMENT, PAY & LEAVE -->
            <div class="form-section">
                <h2 class="section-title" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">RETIREMENT, PAY & LEAVE</h2>
                
                <!-- Service Computation Dates -->
                <div class="mb-4">
                    <h4 style="font-weight: bold; font-size: 13px;">What are your Service Computation Dates?</h4>
                    <p style="font-size: 11px; font-style: italic; margin-bottom: 10px;">The Leave SCD (on the pay stub) may be different than the Retirement SCD that is used for creditable retirement purposes. Give both, if known.</p>
                    
                    <div class="row">
                        <div class="col-md-3">
                            <label class="form-label" style="font-weight: bold; font-size: 12px;">Leave SCD <span class="text-danger">(required)</span>:</label>
                            <input type="date" name="leave_scd" id="leave_scd" class="form-control form-control-sm" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" style="font-weight: bold; font-size: 12px;">Retirement SCD <span class="text-muted">(if known)</span>:</label>
                            <input type="date" name="retirement_scd" class="form-control form-control-sm">
                        </div>
                    </div>
                </div>
                
                <!-- Retirement Timing -->
                <div class="mb-4">
                    <h4 style="font-weight: bold; font-size: 13px;">When are you planning to retire? <span style="font-weight: normal;">(Please check <u>ONE</u>)</span></h4>
                    <p style="font-size: 11px; font-style: italic; margin-bottom: 10px;">To ensure there is no gap between payments, employees are encouraged to retire on the last day of the month.</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="retirement_fully_eligible" id="timing_eligible">
                                <label class="form-check-label" for="timing_eligible" style="font-size: 12px;">
                                    Fully-eligible (no penalty)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="retirement_mra_10" id="timing_mra">
                                <label class="form-check-label" for="timing_mra" style="font-size: 12px;">
                                    MRA+10
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row mb-2">
                                <div class="col-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="retirement_by_age" id="timing_age">
                                        <label class="form-check-label" for="timing_age" style="font-size: 12px;">
                                            Age:
                                        </label>
                                    </div>
                                </div>
                                <div class="col-9">
                                    <input type="number" name="retirement_age" class="form-control form-control-sm" min="0" max="120">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="retirement_by_date" id="timing_date">
                                        <label class="form-check-label" for="timing_date" style="font-size: 12px;">
                                            Date:
                                        </label>
                                    </div>
                                </div>
                                <div class="col-9">
                                    <input type="date" name="desired_retirement_date" id="desired_retirement_date" class="form-control form-control-sm" min="{% now 'Y-m-d' %}" max="2099-12-31">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Maximum Pension Protection -->
                <div class="mb-4">
                    <div class="row">
                        <div class="col-md-8">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">Is there any reason we should plan on <u>NOT</u> providing less than the maximum pension protection to your <u>current</u> spouse?</h4>
                            <p style="font-size: 10px; font-style: italic; margin-bottom: 10px;">Your spouse is <u>entitled</u> to a maximum benefit, unless otherwise agreed.</p>
                        </div>
                        <div class="col-md-2">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="reduce_spousal_pension" value="Yes" id="max_pension_yes">
                                <label class="form-check-label" for="max_pension_yes" style="font-size: 12px;">
                                    Yes
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="reduce_spousal_pension" value="No" id="max_pension_no">
                                <label class="form-check-label" for="max_pension_no" style="font-size: 12px;">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size: 11px; margin-bottom: 5px;">Reason:</label>
                            <input type="text" name="spouse_protection_reason" class="form-control form-control-sm">
                        </div>
                    </div>
                </div>

                <!-- Court Order -->
                <div class="mb-4">
                    <div class="row">
                        <div class="col-md-8">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">Is there a court order that grants any of your federal benefits (pension, SBP, TSP) to a <u>former</u> spouse?</h4>
                        </div>
                        <div class="col-md-2">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="court_order_dividing_benefits" value="Yes" id="court_order_yes">
                                <label class="form-check-label" for="court_order_yes" style="font-size: 12px;">
                                    Yes
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="court_order_dividing_benefits" value="No" id="court_order_no">
                                <label class="form-check-label" for="court_order_no" style="font-size: 12px;">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size: 11px; margin-bottom: 5px;">(If yes, describe in Notes below or provide a copy for review)</label>
                        </div>
                    </div>
                </div>

                <!-- Current Annual Salary -->
                <div class="mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 0;">What is your current annual salary (including locality pay)?</h4>
                        </div>
                        <div class="col-md-4">
                            <div class="row align-items-center">
                                <div class="col-md-4">
                                    <label class="form-label mb-0" style="font-size: 12px;">Salary:</label>
                                </div>
                                <div class="col-md-8">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="current_annual_salary" class="form-control" min="0" step="1">
                                        <span class="input-group-text">/yr</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- High-3 Years -->
                <div class="mb-4">
                    <div class="row">
                        <div class="col-md-8">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">Do you expect to earn your highest 3 years of pay at the end of your career?</h4>
                            <p style="font-size: 10px; font-style: italic; margin-bottom: 0;">If not, provide highest salary history below.</p>
                        </div>
                        <div class="col-md-2">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="expects_highest_three" value="Yes" id="high3_yes">
                                <label class="form-check-label" for="high3_yes" style="font-size: 12px;">
                                    Yes
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="expects_highest_three" value="No" id="high3_no">
                                <label class="form-check-label" for="high3_no" style="font-size: 12px;">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size: 11px; margin-bottom: 5px;">(If no, provide highest salary history in Notes below)</label>
                        </div>
                    </div>
                </div>

                <!-- Leave Balances -->
                <div class="mb-4">
                    <div class="row">
                        <div class="col-md-6">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">What are your current <u>sick leave</u> & <u>annual leave</u> balances?</h4>
                            <p style="font-size: 10px; font-style: italic; margin-bottom: 10px;">If you plan to use all of your leave before you retire, leave blank.</p>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" style="font-size: 11px; margin-bottom: 5px;">Sick Leave:</label>
                            <input type="text" name="sick_leave_balance" class="form-control form-control-sm" placeholder="hours">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label" style="font-size: 11px; margin-bottom: 5px;">Annual Leave:</label>
                            <input type="text" name="annual_leave_balance" class="form-control form-control-sm" placeholder="hours">
                        </div>
                    </div>
                </div>

                <!-- Social Security -->
                <div class="mb-4">
                    <div class="row">
                        <div class="col-md-5">
                            <h4 style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">What is your Social Security benefit at age 62 <u>and</u> at your desired start age?</h4>
                            <p style="font-size: 10px; font-style: italic; margin-bottom: 10px;">The "age 62" SS benefit affects other benefits, so please include it. If already drawing SS, use current age & benefit.</p>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3">
                                <label class="form-label" style="font-weight: bold; font-size: 11px; margin-bottom: 8px;">SS at age 62:</label>
                                <div class="row align-items-center">
                                    <div class="col-md-2">
                                        <label class="form-label mb-0" style="font-size: 11px;">Age</label>
                                    </div>
                                    <div class="col-md-2">
                                        <input type="number" name="ss_age_62" class="form-control form-control-sm text-center" value="62" readonly style="background: #f0f0f0;">
                                    </div>
                                    <div class="col-md-1"></div>
                                    <div class="col-md-1">
                                        <span class="input-group-text" style="font-size: 11px;">$</span>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="number" name="ss_benefit_62" class="form-control form-control-sm" min="0" step="1">
                                    </div>
                                    <div class="col-md-2">
                                        <span style="font-size: 11px;">/mo</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="form-label" style="font-weight: bold; font-size: 11px; margin-bottom: 8px;">SS at desired start age:</label>
                                <div class="row align-items-center">
                                    <div class="col-md-2">
                                        <label class="form-label mb-0" style="font-size: 11px;">Age</label>
                                    </div>
                                    <div class="col-md-2">
                                        <input type="number" name="ss_desired_age" class="form-control form-control-sm" min="62" max="70" step="1">
                                    </div>
                                    <div class="col-md-1"></div>
                                    <div class="col-md-1">
                                        <span class="input-group-text" style="font-size: 11px;">$</span>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="number" name="ss_benefit_desired" class="form-control form-control-sm" min="0" step="1">
                                    </div>
                                    <div class="col-md-2">
                                        <span style="font-size: 11px;">/mo</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notes Section -->
                <div class="mb-3">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 5px;">Notes:</h4>
                    <textarea name="retirement_pay_leave_notes" id="retirement_pay_leave_notes" class="form-control" rows="4"></textarea>
                </div>
            </div>

            <!-- MILITARY SERVICE -->
            <div class="form-section">
                <div class="d-flex align-items-center mb-3" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">
                    <div class="form-check me-3">
                        <input class="form-check-input" type="checkbox" name="no_military_service" id="no_military_service">
                        <label class="form-check-label" for="no_military_service">
                            No to ALL military service
                        </label>
                    </div>
                    <h2 class="section-title mb-0" style="flex: 1; text-align: center; background: transparent;">MILITARY SERVICE</h2>
                </div>

                <!-- Military – Active Duty -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 15px;">Military – Active Duty</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="2" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Do you have any military service on <u>active duty</u>?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="active_duty" id="active_duty_yes">
                                            <label class="form-check-label" for="active_duty_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="active_duty" id="active_duty_no">
                                            <label class="form-check-label" for="active_duty_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of <u>ACTIVE DUTY</u> service?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="active_duty_start" id="active_duty_start" class="form-control form-control-sm" style="width: 45%;">
                                        <span>to</span>
                                        <input type="date" name="active_duty_end" id="active_duty_end" class="form-control form-control-sm" style="width: 45%;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Have you already made a deposit into CSRS/FERS to get credit for this time?</label>
                                </td>
                                <td style="padding: 10px; text-align: center;">
                                    <div class="d-flex justify-content-center gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="military_deposit" id="mil_deposit_yes">
                                            <label class="form-check-label" for="mil_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="military_deposit" id="mil_deposit_no">
                                            <label class="form-check-label" for="mil_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="military_deposit" id="mil_deposit_unsure">
                                            <label class="form-check-label" for="mil_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">How much do you <u>currently</u> still owe?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="military_owe_zero" id="mil_owe_zero">
                                            <label class="form-check-label" for="mil_owe_zero">$ 0</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="military_owe_amount_check" id="mil_owe_amount_check">
                                            <label class="form-check-label" for="mil_owe_amount_check">$</label>
                                        </div>
                                        <input type="number" name="military_owe_amount" class="form-control form-control-sm" min="0" step="0.01" style="width: 100px;">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="military_owe" id="mil_owe_unsure">
                                            <label class="form-check-label" for="mil_owe_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Did any military service interrupt federal service (called "Leave Without Pay – US")? List dates.</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="lwop_us_start" class="form-control form-control-sm" style="width: 40%;">
                                        <span>to</span>
                                        <input type="date" name="lwop_us_end" class="form-control form-control-sm" style="width: 40%;">
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">If so, did you make a deposit for that time?</label>
                                    <div class="d-flex justify-content-center gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="lwop_deposit" id="lwop_deposit_yes">
                                            <label class="form-check-label" for="lwop_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="lwop_deposit" id="lwop_deposit_no">
                                            <label class="form-check-label" for="lwop_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="lwop_deposit" id="lwop_deposit_unsure">
                                            <label class="form-check-label" for="lwop_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Did you <u>RETIRE</u> from <u>ACTIVE DUTY</u>?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex justify-content-center gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="retired_active_duty" id="retired_ad_yes">
                                            <label class="form-check-label" for="retired_ad_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="retired_active_duty" id="retired_ad_no">
                                            <label class="form-check-label" for="retired_ad_no">No</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">If so, what is your military pension amount?</label>
                                </td>
                                <td colspan="2" style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <span>Pension amount:</span>
                                        <div class="input-group input-group-sm" style="width: 200px;">
                                            <span class="input-group-text">$</span>
                                            <input type="number" name="military_pension_amount" class="form-control" min="0" step="0.01">
                                            <span class="input-group-text">/mo</span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Was extra time added to your SCD for overseas/campaign service?</label>
                                </td>
                                <td colspan="2" style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <span>How much (if any):</span>
                                        <input type="text" name="scd_overseas_time" class="form-control form-control-sm" style="width: 200px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="military_active_duty_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Military – Reserves -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 15px;">Military – Reserves</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="9" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Do you have any military service in the <u>reserves</u>?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve" id="reserve_yes">
                                            <label class="form-check-label" for="reserve_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve" id="reserve_no">
                                            <label class="form-check-label" for="reserve_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of <u>RESERVE</u> service?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="reserve_start" id="reserve_start" class="form-control form-control-sm" style="width: 45%;">
                                        <span>to</span>
                                        <input type="date" name="reserve_end" id="reserve_end" class="form-control form-control-sm" style="width: 45%;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">How much reserve time is creditable in CSRS/FERS?</label>
                                    <p style="font-size: 10px; font-style: italic; margin: 5px 0;">Determined when deposit calculated.</p>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <div style="display: flex; gap: 10px;">
                                            <div>
                                                <label style="font-size: 10px;">YY</label>
                                                <input type="number" name="reserve_credit_years" class="form-control form-control-sm" min="0" style="width: 60px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 10px;">MM</label>
                                                <input type="number" name="reserve_credit_months" class="form-control form-control-sm" min="0" max="11" style="width: 60px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 10px;">DD</label>
                                                <input type="number" name="reserve_credit_days" class="form-control form-control-sm" min="0" max="30" style="width: 60px;">
                                            </div>
                                        </div>
                                        <div class="form-check ms-3">
                                            <input class="form-check-input" type="radio" name="reserve_credit" id="reserve_credit_unsure">
                                            <label class="form-check-label" for="reserve_credit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Have you already made a deposit into CSRS/FERS to get credit for this time?</label>
                                </td>
                                <td style="padding: 10px; text-align: center;">
                                    <div class="d-flex justify-content-center gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_deposit" id="res_deposit_yes">
                                            <label class="form-check-label" for="res_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_deposit" id="res_deposit_no">
                                            <label class="form-check-label" for="res_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_deposit" id="res_deposit_unsure">
                                            <label class="form-check-label" for="res_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">How much do you <u>currently</u> still owe?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="reserve_owe_zero" id="res_owe_zero">
                                            <label class="form-check-label" for="res_owe_zero">$ 0</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="reserve_owe_amount_check" id="res_owe_amount_check">
                                            <label class="form-check-label" for="res_owe_amount_check">$</label>
                                        </div>
                                        <input type="number" name="reserve_owe_amount" class="form-control form-control-sm" min="0" step="0.01" style="width: 100px;">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_owe" id="res_owe_unsure">
                                            <label class="form-check-label" for="res_owe_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Did any military service interrupt federal service (called "Leave Without Pay – US")? List dates.</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="reserve_lwop_us_start" class="form-control form-control-sm" style="width: 40%;">
                                        <span>to</span>
                                        <input type="date" name="reserve_lwop_us_end" class="form-control form-control-sm" style="width: 40%;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">If so, did you make a deposit for that time?</label>
                                </td>
                                <td style="padding: 10px; text-align: center;">
                                    <div class="d-flex justify-content-center gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_lwop_deposit" id="res_lwop_deposit_yes">
                                            <label class="form-check-label" for="res_lwop_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_lwop_deposit" id="res_lwop_deposit_no">
                                            <label class="form-check-label" for="res_lwop_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="reserve_lwop_deposit" id="res_lwop_deposit_unsure">
                                            <label class="form-check-label" for="res_lwop_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Did you <u>RETIRE</u> from the <u>RESERVES</u>?</label>
                                </td>
                                <td style="padding: 10px; text-align: center;">
                                    <div class="d-flex justify-content-center gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="retired_reserves" id="retired_res_yes">
                                            <label class="form-check-label" for="retired_res_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="retired_reserves" id="retired_res_no">
                                            <label class="form-check-label" for="retired_res_no">No</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">If so, what is your military pension amount?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <span>Pension amount:</span>
                                        <div class="input-group input-group-sm" style="width: 180px;">
                                            <span class="input-group-text">$</span>
                                            <input type="number" name="reserve_pension_amount" class="form-control" min="0" step="0.01">
                                            <span class="input-group-text">/mo</span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">When does your reserve pension begin?</label>
                                    <p style="font-size: 10px; font-style: italic; margin: 5px 0;">Typically, reserve pensions begin at age 60.</p>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <span>Pension start age:</span>
                                        <input type="number" name="reserve_pension_start_age" class="form-control form-control-sm" min="0" max="100" style="width: 80px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="military_reserves_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Military – Academy -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 15px;">Military – Academy</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="5" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Do you have any military <u>academy</u> service?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_service" value="Yes" id="academy_yes">
                                            <label class="form-check-label" for="academy_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_service" value="No" id="academy_no">
                                            <label class="form-check-label" for="academy_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of <u>ACADEMY</u> service?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="academy_start" id="academy_start" class="form-control form-control-sm" style="width: 150px;">
                                        <span>to</span>
                                        <input type="date" name="academy_end" id="academy_end" class="form-control form-control-sm" style="width: 150px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Have you already made a deposit into CSRS/FERS to get credit for this time?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_deposit_made" value="Yes" id="acad_deposit_yes">
                                            <label class="form-check-label" for="acad_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_deposit_made" value="No" id="acad_deposit_no">
                                            <label class="form-check-label" for="acad_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_deposit_made" value="Unsure" id="acad_deposit_unsure">
                                            <label class="form-check-label" for="acad_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <label style="font-weight: bold;">How much do you <u>currently</u> still owe?</label>
                                        <div class="d-flex gap-2 align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="academy_owe_type" value="zero" id="acad_owe_zero">
                                                <label class="form-check-label" for="acad_owe_zero">$ 0</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="academy_owe_type" value="amount" id="acad_owe_amount">
                                                <label class="form-check-label" for="acad_owe_amount">$</label>
                                            </div>
                                            <input type="number" name="academy_owe_amount" class="form-control form-control-sm" style="width: 100px;" min="0" step="0.01">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="academy_owe_type" value="unsure" id="acad_owe_unsure">
                                                <label class="form-check-label" for="acad_owe_unsure">Unsure</label>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Does it appear that your academy time is included in your Leave SCD?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_in_leave_scd" value="Yes" id="acad_scd_yes">
                                            <label class="form-check-label" for="acad_scd_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_in_leave_scd" value="No" id="acad_scd_no">
                                            <label class="form-check-label" for="acad_scd_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="academy_in_leave_scd" value="Unsure" id="acad_scd_unsure">
                                            <label class="form-check-label" for="acad_scd_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="military_academy_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SPECIAL TYPES OF FEDERAL SERVICE -->
            <div class="form-section">
                <div class="d-flex align-items-center mb-3" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">
                    <div class="form-check me-3">
                        <input class="form-check-input" type="checkbox" name="no_special_service" id="no_special_service">
                        <label class="form-check-label" for="no_special_service">
                            No to ALL special service
                        </label>
                    </div>
                    <h2 class="section-title mb-0" style="flex: 1; text-align: center; background: transparent;">SPECIAL TYPES OF FEDERAL SERVICE</h2>
                </div>

                <!-- Non-Deduction Service -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 10px;">Non-Deduction Service</h4>
                    <p style="font-size: 11px; font-style: italic; margin-bottom: 15px; color: #000;">
                        An employee was not contributing to the CSRS/FERS system. If they are later hired into a permanent position, some employees are allowed to make a deposit to get credit for this service.
                    </p>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="4" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Do you have any federal <u>temporary, interim, casual, seasonal, or intern</u> service?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="non_deduction_service" value="Yes" id="non_deduct_yes">
                                            <label class="form-check-label" for="non_deduct_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="non_deduction_service" value="No" id="non_deduct_no">
                                            <label class="form-check-label" for="non_deduct_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of <u>NON-DEDUCTION</u> service?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="non_deduction_start" id="non_deduction_start" class="form-control form-control-sm" style="width: 150px;">
                                        <span>to</span>
                                        <input type="date" name="non_deduction_end" id="non_deduction_end" class="form-control form-control-sm" style="width: 150px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Have you already made a deposit into CSRS/FERS to get credit for this time?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="non_deduction_deposit_made" value="Yes" id="nd_deposit_yes">
                                            <label class="form-check-label" for="nd_deposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="non_deduction_deposit_made" value="No" id="nd_deposit_no">
                                            <label class="form-check-label" for="nd_deposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="non_deduction_deposit_made" value="Unsure" id="nd_deposit_unsure">
                                            <label class="form-check-label" for="nd_deposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <label style="font-weight: bold;">How much do you <u>currently</u> still owe?</label>
                                        <div class="d-flex gap-2 align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="non_deduction_owe_type" value="zero" id="nd_owe_zero">
                                                <label class="form-check-label" for="nd_owe_zero">$ 0</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="non_deduction_owe_type" value="amount" id="nd_owe_amount">
                                                <label class="form-check-label" for="nd_owe_amount">$</label>
                                            </div>
                                            <input type="number" name="non_deduction_owe_amount" class="form-control form-control-sm" style="width: 100px;" min="0" step="0.01">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="non_deduction_owe_type" value="unsure" id="nd_owe_unsure">
                                                <label class="form-check-label" for="nd_owe_unsure">Unsure</label>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="non_deduction_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Break-in-Service -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 10px;">Break-in-Service</h4>
                    <p style="font-size: 11px; font-style: italic; margin-bottom: 15px; color: #000;">
                        An employee was in a position where they were contributing to CSRS/FERS, but then left federal service. If they took a refund of those contributions, they can repay those funds to regain credit for original service.
                    </p>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="6" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Have you ever left federal service (had a "<u>break-in-service</u>")?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="break_in_service" value="Yes" id="break_service_yes">
                                            <label class="form-check-label" for="break_service_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="break_in_service" value="No" id="break_service_no">
                                            <label class="form-check-label" for="break_service_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of your ORIGINAL service (before leaving)?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="original_service_start" id="original_service_start" class="form-control form-control-sm" style="width: 150px;">
                                        <span>to</span>
                                        <input type="date" name="original_service_end" id="original_service_end" class="form-control form-control-sm" style="width: 150px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of the <u>BREAK-IN-SERVICE</u>?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="break_service_start" id="break_service_start" class="form-control form-control-sm" style="width: 150px;">
                                        <span>to</span>
                                        <input type="date" name="break_service_end" id="break_service_end" class="form-control form-control-sm" style="width: 150px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Did you take a refund of your CSRS/FERS funds when you left?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="took_refund" value="Yes" id="refund_yes">
                                            <label class="form-check-label" for="refund_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="took_refund" value="No" id="refund_no">
                                            <label class="form-check-label" for="refund_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="took_refund" value="Unsure" id="refund_unsure">
                                            <label class="form-check-label" for="refund_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">If so, did you repay ("redeposit") it when you returned to federal service?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="redeposit_made" value="Yes" id="redeposit_yes">
                                            <label class="form-check-label" for="redeposit_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="redeposit_made" value="No" id="redeposit_no">
                                            <label class="form-check-label" for="redeposit_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="redeposit_made" value="Unsure" id="redeposit_unsure">
                                            <label class="form-check-label" for="redeposit_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <label style="font-weight: bold;">How much do you <u>currently</u> still owe?</label>
                                        <div class="d-flex gap-2 align-items-center">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="break_service_owe_type" value="zero" id="break_owe_zero">
                                                <label class="form-check-label" for="break_owe_zero">$ 0</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="break_service_owe_type" value="amount" id="break_owe_amount">
                                                <label class="form-check-label" for="break_owe_amount">$</label>
                                            </div>
                                            <input type="number" name="break_service_owe_amount" class="form-control form-control-sm" style="width: 100px;" min="0" step="0.01">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="break_service_owe_type" value="unsure" id="break_owe_unsure">
                                                <label class="form-check-label" for="break_owe_unsure">Unsure</label>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="break_in_service_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Part-Time Service -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; margin-bottom: 10px;">Part-Time Service</h4>
                    <p style="font-size: 11px; font-style: italic; margin-bottom: 15px; color: #000;">
                        An employee is scheduled to work less than 40 hours per week. The pension will be prorated based on the percentage of time worked. Part-time service can also be "non-deduction" service (see above).
                    </p>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td rowspan="4" style="width: 25%; vertical-align: top; padding: 10px;">
                                    <label style="font-weight: bold;">Have you had any federal <u>part-time</u> service?</label>
                                    <div class="mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="part_time_service" value="Yes" id="part_time_yes">
                                            <label class="form-check-label" for="part_time_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="part_time_service" value="No" id="part_time_no">
                                            <label class="form-check-label" for="part_time_no">No</label>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Dates of <u>PART-TIME</u> service?</label>
                                    <div class="d-flex align-items-center gap-2 mt-2">
                                        <input type="date" name="part_time_start" id="part_time_start" class="form-control form-control-sm" style="width: 150px;">
                                        <span>to</span>
                                        <input type="date" name="part_time_end" id="part_time_end" class="form-control form-control-sm" style="width: 150px;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <label style="font-weight: bold;">How many hours per week?</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <span># hours per week:</span>
                                            <input type="number" name="part_time_hours_per_week" class="form-control form-control-sm" min="0" max="40" step="0.5" style="width: 100px;">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">During this time, did you contribute to the retirement system (CSRS/FERS)?</label>
                                    <div class="d-flex justify-content-end gap-3 mt-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="part_time_contributed" value="Yes" id="pt_contrib_yes">
                                            <label class="form-check-label" for="pt_contrib_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="part_time_contributed" value="No" id="pt_contrib_no">
                                            <label class="form-check-label" for="pt_contrib_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="part_time_contributed" value="Unsure" id="pt_contrib_unsure">
                                            <label class="form-check-label" for="pt_contrib_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="part_time_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Other Pertinent Details -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">Other Pertinent Details</h4>
                    
                    <div style="background: white; padding: 15px; border: 1px solid #dee2e6;">
                        <label style="font-weight: normal; font-size: 12px; margin-bottom: 10px;">Is there anything else we should know about your service history as we prepare your report?</label>
                        <textarea name="other_pertinent_details" class="form-control form-control-sm" rows="6"></textarea>
                    </div>
                </div>

                <!-- FEDERAL EMPLOYEES GROUP LIFE INSURANCE (FEGLI) -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">FEDERAL EMPLOYEES GROUP LIFE INSURANCE (FEGLI)</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <div class="mb-2">
                                        <label style="font-weight: bold;">How much do you currently pay for coverage?</label>
                                        <p style="font-size: 11px; font-style: italic; margin-bottom: 10px; color: #000;">
                                            Let us list all FEGLI premiums exactly as shown on the pay stub (even if you are unsure which coverage it pertains to). We will determine coverage based on the total premium.
                                        </p>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold;">Basic & Optional Coverage (A, B & C) – <em>shown on up to 4 lines on pay stub</em></label>
                                        <div class="d-flex gap-2 mt-2">
                                            <div class="input-group input-group-sm" style="max-width: 150px;">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="fegli_premium_1" class="form-control" min="0" step="0.01">
                                                <span class="input-group-text">/pp</span>
                                            </div>
                                            <div class="input-group input-group-sm" style="max-width: 150px;">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="fegli_premium_2" class="form-control" min="0" step="0.01">
                                                <span class="input-group-text">/pp</span>
                                            </div>
                                            <div class="input-group input-group-sm" style="max-width: 150px;">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="fegli_premium_3" class="form-control" min="0" step="0.01">
                                                <span class="input-group-text">/pp</span>
                                            </div>
                                            <div class="input-group input-group-sm" style="max-width: 150px;">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="fegli_premium_4" class="form-control" min="0" step="0.01">
                                                <span class="input-group-text">/pp</span>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; width: 60%;">
                                    <label style="font-weight: bold;">Will you have ALL of this coverage in place for <u>at least 5 years</u> immediately before you retire?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_5_years_coverage" value="Yes" id="fegli_5yr_yes">
                                            <label class="form-check-label" for="fegli_5yr_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_5_years_coverage" value="No" id="fegli_5yr_no">
                                            <label class="form-check-label" for="fegli_5yr_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_5_years_coverage" value="Unsure" id="fegli_5yr_unsure">
                                            <label class="form-check-label" for="fegli_5yr_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Do you wish to keep this coverage in retirement?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_keep_in_retirement" value="Yes" id="fegli_keep_yes">
                                            <label class="form-check-label" for="fegli_keep_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_keep_in_retirement" value="No" id="fegli_keep_no">
                                            <label class="form-check-label" for="fegli_keep_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_keep_in_retirement" value="Unsure" id="fegli_keep_unsure">
                                            <label class="form-check-label" for="fegli_keep_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Is FEGLI your sole source of life insurance and what is your purpose for having it?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-2 align-items-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_sole_source" value="Yes" id="fegli_sole_yes">
                                            <label class="form-check-label" for="fegli_sole_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fegli_sole_source" value="No" id="fegli_sole_no">
                                            <label class="form-check-label" for="fegli_sole_no">No</label>
                                        </div>
                                        <span style="margin-left: 10px;">Purpose:</span>
                                        <input type="text" name="fegli_purpose" class="form-control form-control-sm" style="flex: 1;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">What are the ages of your dependent children?</label>
                                    <p style="font-size: 11px; font-style: italic; margin: 5px 0 0 0; color: #000;">Include unmarried children under age 22 (older, if disabled).</p>
                                </td>
                                <td style="padding: 10px;">
                                    <div>
                                        <span style="font-size: 11px;">Children's ages:</span>
                                        <input type="text" name="children_ages" class="form-control form-control-sm" placeholder="e.g., 8, 12, 16">
                                        <p style="font-size: 10px; font-style: italic; margin: 3px 0 0 0; color: #000;">Asterisk any children disabled prior to age 22 and incapable of self-support.</p>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="fegli_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FEDERAL EMPLOYEES HEALTH BENEFITS (FEHB) -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">FEDERAL EMPLOYEES HEALTH BENEFITS (FEHB)</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td colspan="5" style="padding: 10px;">
                                    <label style="font-weight: bold;">How much do you currently pay for coverage?</label>
                                </td>
                            </tr>
                            <tr style="text-align: center;">
                                <td style="padding: 5px; width: 20%;"><strong>Health</strong></td>
                                <td style="padding: 5px; width: 20%;"><strong>Dental</strong></td>
                                <td style="padding: 5px; width: 20%;"><strong>Vision</strong></td>
                                <td style="padding: 5px; width: 20%;"><strong>Dental/Vision</strong></td>
                            </tr>
                            <tr style="text-align: center;">
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fehb_health_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fehb_dental_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fehb_vision_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fehb_dental_vision_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">For the <u>health</u> insurance plan, who is covered?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-2 flex-wrap justify-content-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="fehb_health_self_only" id="fehb_self_only">
                                            <label class="form-check-label" for="fehb_self_only">Self-Only</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="fehb_health_self_one" id="fehb_self_one">
                                            <label class="form-check-label" for="fehb_self_one">Self+One</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="fehb_health_self_family" id="fehb_self_family">
                                            <label class="form-check-label" for="fehb_self_family">Self+Family</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="fehb_health_none" id="fehb_health_none">
                                            <label class="form-check-label" for="fehb_health_none">None</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">Will <u>you</u> have the <u>health</u> coverage in place for <u>at least 5 years</u> immediately before you retire?</label>
                                    <p style="font-size: 10px; font-style: italic; margin: 5px 0 0 0; color: #000;"><em>Family members do NOT have a 5-year requirement.</em></p>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3 justify-content-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_health_5_years" value="Yes" id="fehb_health_5yr_yes">
                                            <label class="form-check-label" for="fehb_health_5yr_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_health_5_years" value="No" id="fehb_health_5yr_no">
                                            <label class="form-check-label" for="fehb_health_5yr_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_health_5_years" value="Unsure" id="fehb_health_5yr_unsure">
                                            <label class="form-check-label" for="fehb_health_5yr_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">Do you wish to keep this coverage in retirement?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3 justify-content-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_keep_in_retirement" value="Yes" id="fehb_ret_yes">
                                            <label class="form-check-label" for="fehb_ret_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_keep_in_retirement" value="No" id="fehb_ret_no">
                                            <label class="form-check-label" for="fehb_ret_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_keep_in_retirement" value="Unsure" id="fehb_ret_unsure">
                                            <label class="form-check-label" for="fehb_ret_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">In retirement, will your spouse be reliant on federal <u>health</u> benefits through your plan?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3 justify-content-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_spouse_reliant" value="Yes" id="fehb_spouse_yes">
                                            <label class="form-check-label" for="fehb_spouse_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_spouse_reliant" value="No" id="fehb_spouse_no">
                                            <label class="form-check-label" for="fehb_spouse_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fehb_spouse_reliant" value="Unsure" id="fehb_spouse_unsure">
                                            <label class="form-check-label" for="fehb_spouse_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">Do you have other <u>health</u> coverage?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-2 flex-wrap">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="other_health_tricare" id="other_tricare">
                                            <label class="form-check-label" for="other_tricare">TRICARE</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="other_health_va" id="other_va">
                                            <label class="form-check-label" for="other_va">VA</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="other_health_spouse_plan" id="other_spouse_plan">
                                            <label class="form-check-label" for="other_spouse_plan">Spouse's plan</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="other_health_private" id="other_private">
                                            <label class="form-check-label" for="other_private">Private health plan</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="5" style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="fehb_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FEDERAL LONG TERM CARE INSURANCE PROGRAM (FLTCIP) -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">FEDERAL LONG TERM CARE INSURANCE PROGRAM (FLTCIP)</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">How much do you currently pay for coverage?</label>
                                </td>
                            </tr>
                            <tr style="text-align: center;">
                                <td style="padding: 5px; width: 33%;"><strong>Employee</strong></td>
                                <td style="padding: 5px; width: 33%;"><strong>Spouse</strong></td>
                                <td style="padding: 5px; width: 34%;"><strong>Other Family</strong></td>
                            </tr>
                            <tr style="text-align: center;">
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fltcip_employee_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fltcip_spouse_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 5px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="fltcip_family_premium" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <div>
                                        <label style="font-weight: bold;">Do you recall what features you elected?</label>
                                        <p style="font-size: 10px; font-style: italic; margin: 5px 0 10px 0; color: #000;">
                                            The options shown are currently available in FLTCIP (with a 90-day waiting period). If purchased prior to 2020, you may have different features available to Print a statement of benefits at LTCFEDS.com.
                                        </p>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-4">
                                            <label style="font-weight: normal;">Daily Benefit: $</label>
                                            <input type="number" name="fltcip_daily_benefit" class="form-control form-control-sm" min="0" step="1" style="width: 120px; display: inline-block;">
                                            <span style="font-size: 11px; margin-left: 5px;">($100 – $450 per day)</span>
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label style="font-weight: normal; margin-right: 10px;">Benefit Period:</label>
                                            <div class="d-inline-flex gap-3">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" name="fltcip_period_2yrs" id="fltcip_2yrs">
                                                    <label class="form-check-label" for="fltcip_2yrs">2 yrs</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" name="fltcip_period_3yrs" id="fltcip_3yrs">
                                                    <label class="form-check-label" for="fltcip_3yrs">3 yrs</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" name="fltcip_period_5yrs" id="fltcip_5yrs">
                                                    <label class="form-check-label" for="fltcip_5yrs">5 yrs</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label style="font-weight: normal; margin-right: 10px;">Inflation Protection:</label>
                                            <div class="d-inline-flex gap-3">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" name="fltcip_inflation_acio" id="fltcip_acio">
                                                    <label class="form-check-label" for="fltcip_acio">ACIO 3%</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" name="fltcip_inflation_fpo" id="fltcip_fpo">
                                                    <label class="form-check-label" for="fltcip_fpo">FPO</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <label style="font-weight: bold;">If you do not currently have this coverage, would you like to discuss various options available?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fltcip_discuss_options" value="Yes" id="fltcip_discuss_yes">
                                            <label class="form-check-label" for="fltcip_discuss_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fltcip_discuss_options" value="No" id="fltcip_discuss_no">
                                            <label class="form-check-label" for="fltcip_discuss_no">No</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="fltcip_discuss_options" value="Unsure" id="fltcip_discuss_unsure">
                                            <label class="form-check-label" for="fltcip_discuss_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="alert alert-warning p-2 m-0" style="font-size: 10px;">
                                        <strong>NOTE:</strong> OPM has suspended new applications until at least Dec 2026
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="padding: 10px;">
                                    <label style="font-weight: bold;">Notes:</label>
                                    <textarea name="fltcip_notes" class="form-control form-control-sm" rows="2"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- THRIFT SAVINGS PLAN (TSP) -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">THRIFT SAVINGS PLAN (TSP)</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td style="padding: 10px; width: 50%;">
                                    <label style="font-weight: bold;">What are the ways you plan to use your TSP in retirement?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3 flex-wrap">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_use_income" id="tsp_income">
                                            <label class="form-check-label" for="tsp_income">Income</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_use_fun_money" id="tsp_fun">
                                            <label class="form-check-label" for="tsp_fun">Fun money</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_use_legacy" id="tsp_legacy">
                                            <label class="form-check-label" for="tsp_legacy">Legacy</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_use_other" id="tsp_other">
                                            <label class="form-check-label" for="tsp_other">Other</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">What is your goal to have in TSP by the time you retire?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="input-group input-group-sm" style="max-width: 200px;">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_goal_amount" class="form-control" min="0" step="1000">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;"><u>HOW MUCH</u> do you plan to need & <u>WHEN</u> do you need it?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2 flex-wrap">
                                        <div class="input-group input-group-sm" style="max-width: 150px;">
                                            <span class="input-group-text">$</span>
                                            <input type="number" name="tsp_need_amount" class="form-control" min="0" step="1000">
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_need_asap" id="tsp_asap">
                                            <label class="form-check-label" for="tsp_asap">ASAP!</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_need_at_age" id="tsp_at_age">
                                            <label class="form-check-label" for="tsp_at_age">At age:</label>
                                        </div>
                                        <input type="number" name="tsp_need_age" class="form-control form-control-sm" min="0" max="100" style="width: 70px;">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_need_unsure" id="tsp_need_unsure">
                                            <label class="form-check-label" for="tsp_need_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Is the TSP your sole source of investing?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="tsp_sole_source" value="Yes" id="tsp_sole_yes">
                                            <label class="form-check-label" for="tsp_sole_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="tsp_sole_source" value="No" id="tsp_sole_no">
                                            <label class="form-check-label" for="tsp_sole_no">No</label>
                                        </div>
                                        <span style="margin-left: 10px;">Explain:</span>
                                        <input type="text" name="tsp_sole_explain" class="form-control form-control-sm" style="flex: 1;">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">What do you plan to do with TSP when you retire?</label>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_plan_leave" id="tsp_leave">
                                            <label class="form-check-label" for="tsp_leave">Leave in TSP</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_plan_rollover" id="tsp_rollover">
                                            <label class="form-check-label" for="tsp_rollover">Rollover to IRA</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_plan_unsure" id="tsp_plan_unsure">
                                            <label class="form-check-label" for="tsp_plan_unsure">Unsure</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">While working, have you taken an in-service withdrawal?</label>
                                    <p style="font-size: 10px; font-style: italic; margin: 5px 0 0 0; color: #000;"><em>Note: this is different than a TSP loan.</em></p>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="d-flex align-items-center gap-2 flex-wrap">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="tsp_in_service_withdrawal" value="Yes" id="tsp_withdrawal_yes">
                                            <label class="form-check-label" for="tsp_withdrawal_yes">Yes</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="tsp_in_service_withdrawal" value="No" id="tsp_withdrawal_no">
                                            <label class="form-check-label" for="tsp_withdrawal_no">No</label>
                                        </div>
                                        <div class="form-check ms-3">
                                            <input class="form-check-input" type="checkbox" name="tsp_withdrawal_hardship" id="tsp_hardship">
                                            <label class="form-check-label" for="tsp_hardship">Financial Hardship</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="tsp_withdrawal_age_based" id="tsp_age_based">
                                            <label class="form-check-label" for="tsp_age_based">Age-Based (59½ or later)</label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- NEW CONTRIBUTIONS -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px; color: #0066cc;">NEW CONTRIBUTIONS</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <tbody>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Regular contribution limit:</label>
                                    <span style="font-size: 11px;">$23,500/yr (average of $904/pp)</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Catch-up contribution limit (50+):</label>
                                    <span style="font-size: 11px;">$7,500/yr (average of $289/pp)</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Catch-up contribution limit (60-63):</label>
                                    <span style="font-size: 11px;">$11,250/yr (average of $433/pp)</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-style: italic; font-size: 11px; color: #666;">
                                    <em>The TSP considers anything over $23,000 a catch-up.</em>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-style: italic; font-size: 11px; color: #666;">
                                    <em>Employees can split their new contributions in any combination between the Traditional & Roth TSP accounts.</em>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Traditional contributions</label>
                                    <div class="input-group input-group-sm mt-2" style="max-width: 200px;">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_traditional_contributions" class="form-control" min="0" step="1">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    <label style="font-weight: bold;">Roth contributions</label>
                                    <div class="input-group input-group-sm mt-2" style="max-width: 200px;">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_roth_contributions" class="form-control" min="0" step="1">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- OUTSTANDING TSP LOANS -->
                <div class="mb-4" style="background: #e9ecef; padding: 15px; margin-bottom: 15px;">
                    <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px; color: #0066cc;">OUTSTANDING TSP LOANS</h4>
                    
                    <table class="table table-bordered" style="background: white; font-size: 12px;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; width: 25%; font-weight: bold;">Loan Type</th>
                                <th style="padding: 10px; width: 37.5%; font-weight: bold;">GENERAL PURPOSE</th>
                                <th style="padding: 10px; width: 37.5%; font-weight: bold;">RESIDENTIAL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px;"></td>
                                <td style="padding: 10px; font-size: 11px; font-style: italic;">
                                    <em>(repaid in 1-5 years)</em>
                                </td>
                                <td style="padding: 10px; font-size: 11px; font-style: italic;">
                                    <em>(repaid in 1-15 years)</em>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: bold;">Date Loan Taken</td>
                                <td style="padding: 10px;">
                                    <input type="date" name="tsp_loan_general_date" class="form-control form-control-sm">
                                </td>
                                <td style="padding: 10px;">
                                    <input type="date" name="tsp_loan_residential_date" class="form-control form-control-sm">
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: bold;">Current Balance</td>
                                <td style="padding: 10px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_loan_general_balance" class="form-control" min="0" step="0.01">
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_loan_residential_balance" class="form-control" min="0" step="0.01">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: bold;">Repayment amount</td>
                                <td style="padding: 10px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_loan_general_repayment" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                                <td style="padding: 10px;">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text">$</span>
                                        <input type="number" name="tsp_loan_residential_repayment" class="form-control" min="0" step="0.01">
                                        <span class="input-group-text">/pp</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; font-weight: bold;">Payoff Date (approx.)</td>
                                <td style="padding: 10px;">
                                    <input type="date" name="tsp_loan_general_payoff_date" class="form-control form-control-sm">
                                </td>
                                <td style="padding: 10px;">
                                    <input type="date" name="tsp_loan_residential_payoff_date" class="form-control form-control-sm">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- FUNDS TABLE -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div style="background: #e9ecef; padding: 15px;">
                            <table class="table table-bordered" style="background: white; font-size: 12px; margin-bottom: 0;">
                                <thead>
                                    <tr style="background: #f8f9fa;">
                                        <th style="padding: 8px; font-weight: bold;">FUNDS</th>
                                        <th style="padding: 8px; font-weight: bold;">BALANCE<br><span style="font-size: 10px;">of <u>existing</u> money</span></th>
                                        <th style="padding: 8px; font-weight: bold;">ALLOCATION<br><span style="font-size: 10px;">of <u>new</u> money</span></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">G Fund</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_g_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_g_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">F Fund</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_f_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_f_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">C Fund</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_c_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_c_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">S Fund</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_s_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_s_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">I Fund</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_i_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_i_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L Income</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l_income_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l_income_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2025</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2025_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2025_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2030</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2030_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2030_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2035</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2035_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2035_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2040</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2040_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2040_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2045</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2045_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2045_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2050</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2050_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2050_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2055</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2055_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2055_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2060</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2060_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2060_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; font-weight: bold;">L 2065/70</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="number" name="tsp_l2065_70_balance" class="form-control" min="0" step="0.01">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="number" name="tsp_l2065_70_allocation" class="form-control" min="0" max="100" step="1">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr style="background: #f8f9fa; font-weight: bold;">
                                        <td style="padding: 8px;">TOTAL</td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <span class="input-group-text">$</span>
                                                <input type="text" id="tsp_balance_total" class="form-control" value="0" readonly style="background: #e9ecef;">
                                            </div>
                                        </td>
                                        <td style="padding: 8px;">
                                            <div class="input-group input-group-sm">
                                                <input type="text" id="tsp_allocation_total" class="form-control" value="0" readonly style="background: #e9ecef;">
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr id="allocation_error_row" style="display: none;">
                                        <td colspan="3" style="padding: 8px; background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb;">
                                            <i class="bi bi-exclamation-triangle-fill"></i>
                                            <strong>Allocation Error:</strong> <span id="allocation_error_message"></span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div style="background: #e9ecef; padding: 15px; height: 100%;">
                            <h4 style="font-weight: bold; font-size: 13px; text-align: center; background: #d9d9d9; padding: 10px; margin: -15px -15px 15px -15px;">RISK & END RESULTS</h4>
                            
                            <table class="table table-bordered" style="background: white; font-size: 12px; margin-bottom: 15px;">
                                <tbody>
                                    <tr>
                                        <td style="padding: 10px; width: 60%;">
                                            <label style="font-weight: bold;">On a scale of 1-10, how would you rate your risk tolerance?</label><br>
                                            <span style="font-size: 11px; font-style: italic;">(1=very conservative & 10=very aggressive)</span>
                                        </td>
                                        <td style="padding: 10px; width: 40%;">
                                            <label style="font-size: 11px; font-weight: bold;">Why?</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px;">
                                            <label style="font-size: 11px;">Employee:</label>
                                            <input type="number" name="risk_tolerance_employee" class="form-control form-control-sm mt-1" min="1" max="10" step="1">
                                        </td>
                                        <td style="padding: 10px;" rowspan="2">
                                            <textarea name="risk_tolerance_why" class="form-control form-control-sm" rows="3" style="height: 100%;"></textarea>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 10px;">
                                            <label style="font-size: 11px;">Spouse:</label>
                                            <input type="number" name="risk_tolerance_spouse" class="form-control form-control-sm mt-1" min="1" max="10" step="1">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <table class="table table-bordered" style="background: white; font-size: 12px; margin-bottom: 15px;">
                                <tbody>
                                    <tr>
                                        <td style="padding: 10px;">
                                            <label style="font-weight: bold;">Thinking about TSP, what is the BEST POSSIBLE END RESULT you could imagine in retirement?</label><br>
                                            <span style="font-size: 10px; font-style: italic;">(Such as: never run out, leave to kids, have enough to do all I dreamed of doing, don't pay too many taxes)</span>
                                            <textarea name="tsp_best_result" class="form-control form-control-sm mt-2" rows="3"></textarea>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <table class="table table-bordered" style="background: white; font-size: 12px; margin-bottom: 15px;">
                                <tbody>
                                    <tr>
                                        <td style="padding: 10px;">
                                            <label style="font-weight: bold;">Thinking about TSP, what is the WORST POSSIBLE END RESULT you could imagine in retirement?</label><br>
                                            <span style="font-size: 10px; font-style: italic;">(Such as: run out too soon, nosedive in the market, my kids have to support me, I don't get to do the retirement I planned)</span>
                                            <textarea name="tsp_worst_result" class="form-control form-control-sm mt-2" rows="3"></textarea>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <table class="table table-bordered" style="background: white; font-size: 12px;">
                                <tbody>
                                    <tr>
                                        <td style="padding: 10px;">
                                            <label style="font-weight: bold; text-align: center; display: block;">COMMENTS / NOTES</label>
                                            <textarea name="tsp_comments" class="form-control form-control-sm mt-2" rows="3"></textarea>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ADDITIONAL NOTES -->
            <div class="form-section">
                <h2 class="section-title" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">ADDITIONAL NOTES</h2>
                
                <p class="mb-3" style="font-style: italic; font-size: 13px; color: #0066cc;">
                    Please use this page to provide any additional information necessary for us to prepare an accurate report for the employee. Of course, feel free to use this area to add any notes that are helpful to you based on other information the employee may share.
                </p>
                
                <div class="mb-3">
                    <textarea name="additional_notes_final" class="form-control" rows="20" placeholder="Enter any additional notes or information here..." style="font-size: 13px;"></textarea>
                </div>
            </div>

            <!-- SUPPORTING DOCUMENTS -->
            <div class="form-section">
                <h2 class="section-title" style="background: #d9d9d9; padding: 10px; margin: -25px -25px 20px -25px;">SUPPORTING DOCUMENTS</h2>
                <p class="text-muted mb-3">Please upload the following documents to help us provide accurate retirement planning advice:</p>
                
                <div class="mb-3">
                    <h5 style="font-weight: bold; font-size: 13px;">Recommended Documents:</h5>
                    <ul class="text-muted" style="font-size: 13px;">
                        <li>Most recent pay stub (showing Leave SCD)</li>
                        <li>Recent TSP statement</li>
                        <li>Social Security statement (from ssa.gov)</li>
                        <li>SF-50 (Notification of Personnel Action) - optional but helpful</li>
                        <li>FEHB enrollment information</li>
                        <li>FEGLI enrollment information</li>
                        <li>Any other relevant benefit statements</li>
                    </ul>
                </div>
                
                <div id="documentSection">
                    <label class="form-label" style="font-weight: bold;">Upload Documents:</label>
                    <div class="mb-3">
                        <div class="row mb-2">
                            <div class="col-md-4">
                                <select class="form-select document-type" name="document_type[]">
                                    <option value="">Document Type...</option>
                                    <option value="Pay Stub">Pay Stub</option>
                                    <option value="TSP Statement">TSP Statement</option>
                                    <option value="Social Security Statement">Social Security Statement</option>
                                    <option value="SF-50">SF-50</option>
                                    <option value="FEHB Information">FEHB Information</option>
                                    <option value="FEGLI Information">FEGLI Information</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <input type="file" class="form-control document-file" name="documents[]" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                            </div>
                            <div class="col-md-2">
                                <button type="button" class="btn btn-sm btn-success" onclick="addDocumentRow()">
                                    <i class="bi bi-plus-circle"></i> Add More
                                </button>
                            </div>
                        </div>
                        <div id="additionalDocuments"></div>
                    </div>
                </div>
            </div>

            <!-- FORM ACTIONS -->
            <div class="form-section text-center" style="border-top: 2px solid #003366; padding-top: 30px;">
                <div class="d-flex justify-content-center gap-3">
                    <button type="button" class="btn btn-lg btn-outline-secondary" onclick="clearForm()">
                        <i class="bi bi-x-circle"></i> CLEAR FORM
                    </button>
                    <button type="button" class="btn btn-lg btn-warning" onclick="saveDraft()">
                        <i class="bi bi-save"></i> SAVE AS DRAFT
                    </button>
                    <button type="submit" class="btn btn-lg btn-primary">
                        <i class="bi bi-send"></i> SUBMIT CASE
                    </button>
                </div>
                <p class="text-muted mt-3" style="font-size: 12px;">
                    <i class="bi bi-info-circle"></i> Your draft will be saved locally for 30 days. Click "SUBMIT CASE" when ready to send to the benefits team.
                </p>
            </div>
    </div>

    <script>
        // Auto-calculate retirement age
        document.addEventListener('DOMContentLoaded', function() {
            const dobInput = document.getElementById('employee_dob');
            const retirementDateInput = document.getElementById('desired_retirement_date');
            
            function calculateRetirementAge() {
                if (dobInput.value && retirementDateInput.value) {
                    const dob = new Date(dobInput.value);
                    const retirementDate = new Date(retirementDateInput.value);
                    
                    // Validate that dates are reasonable (DOB in past, retirement in future)
                    const today = new Date();
                    if (dob > today) {
                        alert('Date of birth cannot be in the future');
                        dobInput.value = '';
                        return;
                    }
                    
                    if (retirementDate.getFullYear() < 1900 || retirementDate.getFullYear() > 2099) {
                        alert('Please enter a valid retirement year (1900-2099)');
                        retirementDateInput.value = '';
                        return;
                    }
                    
                    if (retirementDate < dob) {
                        alert('Retirement date cannot be before date of birth');
                        return;
                    }
                    
                    const age = Math.floor((retirementDate - dob) / (365.25 * 24 * 60 * 60 * 1000));
                    
                    // Validate reasonable age range
                    if (age < 0 || age > 120) {
                        alert('Calculated age seems incorrect. Please verify dates.');
                        return;
                    }
                    
                    const ageInput = document.querySelector('input[name="retirement_age"]');
                    if (ageInput) {
                        ageInput.value = age;
                    }
                }
            }
            
            if (dobInput && retirementDateInput) {
                dobInput.addEventListener('change', calculateRetirementAge);
                retirementDateInput.addEventListener('change', calculateRetirementAge);
            }
            
            // Restore draft on page load (but not if we just submitted)
            const justSubmitted = sessionStorage.getItem('form_just_submitted');
            if (!justSubmitted) {
                restoreDraft();
            } else {
                // Clear the flag
                sessionStorage.removeItem('form_just_submitted');
            }
            
            // Clear draft on successful form submission
            const form = document.getElementById('factFinderForm');
            if (form) {
                form.addEventListener('submit', function() {
                    // Mark that we're submitting
                    sessionStorage.setItem('form_just_submitted', 'true');
                    // Clear the draft since we're submitting
                    localStorage.removeItem('federal_fact_finder_draft');
                    localStorage.removeItem('federal_fact_finder_draft_timestamp');
                });
            }
        });
        
        // Clear form function
        function clearForm() {
            if (confirm('Are you sure you want to clear all form data? This cannot be undone.')) {
                document.getElementById('factFinderForm').reset();
                localStorage.removeItem('federal_fact_finder_draft');
                localStorage.removeItem('federal_fact_finder_draft_timestamp');
                alert('Form cleared successfully.');
            }
        }
        
        // Save draft function
        function saveDraft() {
            const form = document.getElementById('factFinderForm');
            const formData = new FormData(form);
            const draftData = {};
            
            for (let [key, value] of formData.entries()) {
                // Skip file inputs when saving to localStorage
                if (!key.includes('documents')) {
                    draftData[key] = value;
                }
            }
            
            localStorage.setItem('federal_fact_finder_draft', JSON.stringify(draftData));
            localStorage.setItem('federal_fact_finder_draft_timestamp', new Date().getTime());
            
            alert('Draft saved successfully! You can return to this form later to continue.');
        }
        
        // Restore draft function - now shows banner instead of blocking dialog
        function restoreDraft() {
            const draftData = localStorage.getItem('federal_fact_finder_draft');
            const timestamp = localStorage.getItem('federal_fact_finder_draft_timestamp');
            
            if (draftData && timestamp) {
                const daysOld = (new Date().getTime() - parseInt(timestamp)) / (1000 * 60 * 60 * 24);
                
                // Only show banner if draft is less than 30 days old
                if (daysOld < 30) {
                    const banner = document.getElementById('draftBanner');
                    const dateSpan = document.getElementById('draftDate');
                    if (banner && dateSpan) {
                        dateSpan.textContent = 'You have a saved draft from ' + new Date(parseInt(timestamp)).toLocaleDateString();
                        banner.classList.add('show');
                    }
                } else {
                    // Remove expired draft
                    localStorage.removeItem('federal_fact_finder_draft');
                    localStorage.removeItem('federal_fact_finder_draft_timestamp');
                }
            }
        }
        
        // Function to actually restore the draft data
        function restoreDraftData() {
            const draftData = localStorage.getItem('federal_fact_finder_draft');
            if (draftData) {
                const data = JSON.parse(draftData);
                const form = document.getElementById('factFinderForm');
                
                for (let [key, value] of Object.entries(data)) {
                    const elements = form.elements[key];
                    if (elements) {
                        if (elements.type === 'radio' || elements.type === 'checkbox') {
                            // Handle radio buttons and checkboxes
                            const element = form.querySelector(`[name="${key}"][value="${value}"]`);
                            if (element) element.checked = true;
                        } else {
                            elements.value = value;
                        }
                    }
                }
                
                // Hide banner and show success message
                document.getElementById('draftBanner').classList.remove('show');
                alert('Draft restored successfully!');
            }
        }
        
        // Function to dismiss the draft banner
        function dismissDraft() {
            document.getElementById('draftBanner').classList.remove('show');
            // Clear the draft since user dismissed it
            localStorage.removeItem('federal_fact_finder_draft');
            localStorage.removeItem('federal_fact_finder_draft_timestamp');
        }
        
        // Add document row function
        let documentRowCount = 1;
        function addDocumentRow() {
            documentRowCount++;
            const container = document.getElementById('additionalDocuments');
            const newRow = document.createElement('div');
            newRow.className = 'row mb-2';
            newRow.id = `documentRow${documentRowCount}`;
            newRow.innerHTML = `
                <div class="col-md-4">
                    <select class="form-select document-type" name="document_type[]">
                        <option value="">Document Type...</option>
                        <option value="Pay Stub">Pay Stub</option>
                        <option value="TSP Statement">TSP Statement</option>
                        <option value="Social Security Statement">Social Security Statement</option>
                        <option value="SF-50">SF-50</option>
                        <option value="FEHB Information">FEHB Information</option>
                        <option value="FEGLI Information">FEGLI Information</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <input type="file" class="form-control document-file" name="documents[]" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-sm btn-danger" onclick="removeDocumentRow(${documentRowCount})">
                        <i class="bi bi-trash"></i> Remove
                    </button>
                </div>
            `;
            container.appendChild(newRow);
        }
        
        // Remove document row function
        function removeDocumentRow(rowId) {
            const row = document.getElementById(`documentRow${rowId}`);
            if (row) {
                row.remove();
            }
        }
    </script>
</body>
</html>
                            <label class="form-check-label" for="health_benefits">
                                Continue Health Benefits into Retirement (FEHB)
                            </label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Survivor Benefit Election</label>
                        <select name="survivor_benefit_election" class="form-select">
                            <option value="">Select...</option>
                            <option value="Full">Full Survivor Annuity</option>
                            <option value="Partial">Partial Survivor Annuity (50%)</option>
                            <option value="None">No Survivor Benefit</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section 5: Thrift Savings Plan (TSP) -->
            <div class="form-section">
                <h2 class="section-title">Section 5: Thrift Savings Plan (TSP)</h2>
                
                <div class="row form-row">
                    <div class="col-md-4">
                        <label class="form-label">Current TSP Balance</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="tsp_current_balance" class="form-control" min="0" step="1">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Traditional TSP Balance</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="tsp_traditional_balance" class="form-control" min="0" step="1">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Roth TSP Balance</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="tsp_roth_balance" class="form-control" min="0" step="1">
                        </div>
                    </div>
                </div>
                
                <div class="row form-row">
                    <div class="col-md-4">
                        <label class="form-label">Employee Contribution %</label>
                        <div class="input-group">
                            <input type="number" name="tsp_employee_contribution_pct" class="form-control" min="0" max="100" step="1">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Agency Match %</label>
                        <div class="input-group">
                            <input type="number" name="tsp_agency_match_pct" class="form-control" min="0" max="100" step="1" value="5">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Outstanding TSP Loan Balance</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="tsp_loan_balance" class="form-control" min="0" step="1" value="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 6: Social Security -->
            <div class="form-section">
                <h2 class="section-title">Section 6: Social Security</h2>
                
                <div class="row form-row">
                    <div class="col-md-6">
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" name="ss_covered_employment" id="ss_covered" checked>
                            <label class="form-check-label" for="ss_covered">
                                Social Security Covered Employment
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="row form-row">
                    <div class="col-md-6">
                        <label class="form-label">Estimated SS Benefit at Age 62</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="ss_estimated_benefit_age_62" class="form-control" min="0" step="1">
                            <span class="input-group-text">/month</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Estimated SS Benefit at Full Retirement Age</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="ss_estimated_benefit_fra" class="form-control" min="0" step="1">
                            <span class="input-group-text">/month</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 7: Other Income Sources -->
            <div class="form-section">
                <h2 class="section-title">Section 7: Other Income Sources</h2>
                
                <div class="row form-row">
                    <div class="col-md-4">
                        <label class="form-label">Spouse Income (Annual)</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="spouse_income" class="form-control" min="0" step="1" value="0">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Rental Income (Annual)</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="rental_income" class="form-control" min="0" step="1" value="0">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Other Pension Income (Annual)</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="pension_income" class="form-control" min="0" step="1" value="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 8: Additional Information -->
            <div class="form-section">
                <h2 class="section-title">Section 8: Additional Information & Case Details</h2>
                
                <div class="row form-row">
                    <div class="col-md-6">
                        <label class="form-label">Number of Reports Requested</label>
                        <select name="num_reports_requested" class="form-select">
                            <option value="1" selected>1 Report</option>
                            <option value="2">2 Reports</option>
                            <option value="3">3 Reports</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Case Urgency</label>
                        <select name="urgency" class="form-select">
                            <option value="normal" selected>Normal Processing</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                </div>
                
                <div class="row form-row">
                    <div class="col-md-12">
                        <label class="form-label">Additional Notes or Special Requests</label>
                        <textarea name="additional_notes" class="form-control" rows="4" placeholder="Include any additional information that may be relevant to your case..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Document Upload Section -->
            <div class="document-upload-section">
                <h3><i class="bi bi-paperclip"></i> Attach Supporting Documents</h3>
                <p class="mb-3">Upload all required documents before submitting your case. Include pay stub, TSP statement, and Social Security statement.</p>
                
                <div class="row mb-3">
                    <div class="col-md-12">
                        <label class="form-label">Select Document Type:</label>
                        <select id="docType" class="form-select mb-2">
                            <option value="">Choose document type...</option>
                            <option value="Pay Stub">Pay Stub</option>
                            <option value="TSP Statement">TSP Statement</option>
                            <option value="Social Security Statement">Social Security Statement</option>
                            <option value="ID Document">ID Document</option>
                            <option value="Supporting Document">Supporting Document</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-12">
                        <input type="file" id="fileInput" class="form-control" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple>
                        <small class="text-muted">Accepted formats: PDF, DOC, DOCX, JPG, PNG (Max 10MB per file)</small>
                    </div>
                </div>
                
                <button type="button" class="btn btn-sm btn-primary" onclick="addDocument()">
                    <i class="bi bi-plus-circle"></i> Add Document
                </button>
                
                <div id="documentsList" class="mt-3">
                    <!-- Documents will be listed here -->
                </div>
            </div>

            <!-- Submit Section -->
            <div class="submit-section">
                <p class="text-muted mb-3 text-center">
                    <small>By submitting this form, I certify that the information provided is accurate and complete to the best of my knowledge.</small>
                </p>
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                    <a href="{% url 'member_dashboard' %}" class="btn btn-outline-secondary btn-lg px-5">
                        <i class="bi bi-x-circle"></i> Cancel
                    </a>
                    <button type="submit" class="btn btn-primary btn-lg px-5">
                        <i class="bi bi-check-circle"></i> Submit Complete Case
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
// Document management
let documents = [];

function addDocument() {
    const fileInput = document.getElementById('fileInput');
    const docType = document.getElementById('docType');
    
    if (!docType.value) {
        alert('Please select a document type');
        return;
    }
    
    if (!fileInput.files.length) {
        alert('Please select a file');
        return;
    }
    
    Array.from(fileInput.files).forEach(file => {
        if (file.size > 10 * 1024 * 1024) {
            alert(`File ${file.name} is too large (max 10MB)`);
            return;
        }
        
        documents.push({
            type: docType.value,
            file: file,
            name: file.name,
            size: (file.size / 1024).toFixed(2) + ' KB'
        });
    });
    
    renderDocuments();
    fileInput.value = '';
    docType.value = '';
}

function removeDocument(index) {
    documents.splice(index, 1);
    renderDocuments();
}

function renderDocuments() {
    const container = document.getElementById('documentsList');
    if (documents.length === 0) {
        container.innerHTML = '<p class="text-muted"><em>No documents uploaded yet</em></p>';
        return;
    }
    
    container.innerHTML = '<ul class="file-list">' + documents.map((doc, index) => `
        <li class="file-list-item">
            <div>
                <i class="bi bi-file-earmark-pdf"></i>
                <strong>${doc.type}</strong>: ${doc.name} (${doc.size})
            </div>
            <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeDocument(${index})">
                <i class="bi bi-trash"></i> Remove
            </button>
        </li>
    `).join('') + '</ul>';
}

// Clear Form
function clearForm() {
    if (confirm('Are you sure you want to clear all form data? This cannot be undone.')) {
        document.getElementById('factFinderForm').reset();
        documents = [];
        renderDocuments();
        localStorage.removeItem('factFinderDraft');
    }
}

// Save Draft
function saveDraft() {
    const formData = new FormData(document.getElementById('factFinderForm'));
    const data = {};
    formData.forEach((value, key) => {
        data[key] = value;
    });
    
    localStorage.setItem('factFinderDraft', JSON.stringify(data));
    localStorage.setItem('factFinderDraftDate', new Date().toISOString());
    
    alert('Draft saved successfully! You can return later to complete it.');
}

// Load Draft on page load
window.addEventListener('load', function() {
    const draft = localStorage.getItem('factFinderDraft');
    if (draft) {
        const draftDate = new Date(localStorage.getItem('factFinderDraftDate'));
        const daysOld = (new Date() - draftDate) / (1000 * 60 * 60 * 24);
        
        if (daysOld < 30) {
            if (confirm(`You have a draft from ${draftDate.toLocaleDateString()}. Would you like to restore it?`)) {
                const data = JSON.parse(draft);
                Object.keys(data).forEach(key => {
                    const input = document.querySelector(`[name="${key}"]`);
                    if (input) {
                        if (input.type === 'checkbox') {
                            input.checked = data[key] === 'on';
                        } else {
                            input.value = data[key];
                        }
                    }
                });
            }
        } else {
            localStorage.removeItem('factFinderDraft');
            localStorage.removeItem('factFinderDraftDate');
        }
    }
});

// Auto-calculate years of service from SCD
const scdInput = document.querySelector('input[name="service_computation_date"]');
if (scdInput) {
    scdInput.addEventListener('change', function() {
        const scd = new Date(this.value);
        const today = new Date();
        const yearsDiff = (today - scd) / (1000 * 60 * 60 * 24 * 365.25);
        const yearsInput = document.querySelector('input[name="years_of_service"]');
        if (yearsInput) {
            yearsInput.value = yearsDiff.toFixed(1);
        }
    });
}

// Auto-calculate age at retirement
const dobInput = document.querySelector('input[name="date_of_birth"]');
const retireDateInput = document.querySelector('input[name="desired_retirement_date"]');
const retireAgeInput = document.querySelector('input[name="retirement_age"]');

function calculateRetirementAge() {
    if (dobInput && retireDateInput && retireAgeInput) {
        if (dobInput.value && retireDateInput.value) {
            const dob = new Date(dobInput.value);
            const retireDate = new Date(retireDateInput.value);
            const age = (retireDate - dob) / (1000 * 60 * 60 * 24 * 365.25);
            retireAgeInput.value = Math.floor(age);
        }
    }
}

if (dobInput) dobInput.addEventListener('change', calculateRetirementAge);
if (retireDateInput) retireDateInput.addEventListener('change', calculateRetirementAge);

// Employee type focus management
const empFirefighter = document.getElementById('emp_firefighter');
const empATC = document.getElementById('emp_atc');
const empForeign = document.getElementById('emp_foreign');
const ffStartDate = document.getElementById('ff_start_date');
const atcStartDate = document.getElementById('atc_start_date');
const fsStartDate = document.getElementById('fs_start_date');

if (empFirefighter && ffStartDate) {
    empFirefighter.addEventListener('change', function() {
        if (this.checked) {
            ffStartDate.focus();
        }
    });
}

if (empATC && atcStartDate) {
    empATC.addEventListener('change', function() {
        if (this.checked) {
            atcStartDate.focus();
        }
    });
}

if (empForeign && fsStartDate) {
    empForeign.addEventListener('change', function() {
        if (this.checked) {
            fsStartDate.focus();
        }
    });
}

// High-3 salary validation - require notes if "No" is selected
const high3No = document.getElementById('high3_no');
const retirementNotes = document.getElementById('retirement_pay_leave_notes');

if (high3No && retirementNotes) {
    high3No.addEventListener('change', function() {
        if (this.checked) {
            retirementNotes.setAttribute('required', 'required');
            retirementNotes.style.borderColor = '#dc3545';
            retirementNotes.placeholder = 'Please provide highest salary history (REQUIRED when "No" is selected)';
        }
    });
}

const high3Yes = document.getElementById('high3_yes');
if (high3Yes && retirementNotes) {
    high3Yes.addEventListener('change', function() {
        if (this.checked) {
            retirementNotes.removeAttribute('required');
            retirementNotes.style.borderColor = '';
            retirementNotes.placeholder = '';
        }
    });
}

// "No to ALL military service" checkbox logic
const noMilitaryCheckbox = document.getElementById('no_military_service');
const activeDutyYes = document.getElementById('active_duty_yes');
const activeDutyNo = document.getElementById('active_duty_no');
const reserveYes = document.getElementById('reserve_yes');
const reserveNo = document.getElementById('reserve_no');
const academyYes = document.getElementById('academy_yes');
const academyNo = document.getElementById('academy_no');

// Military service focus management - focus on first date field when "Yes" is selected
const activeDutyStartDate = document.getElementById('active_duty_start');
const reserveStartDate = document.getElementById('reserve_start');
const academyStartDate = document.getElementById('academy_start');

if (activeDutyYes && activeDutyStartDate) {
    activeDutyYes.addEventListener('change', function() {
        if (this.checked) {
            activeDutyStartDate.focus();
        }
    });
}

if (reserveYes && reserveStartDate) {
    reserveYes.addEventListener('change', function() {
        if (this.checked) {
            reserveStartDate.focus();
        }
    });
}

if (academyYes && academyStartDate) {
    academyYes.addEventListener('change', function() {
        if (this.checked) {
            academyStartDate.focus();
        }
    });
}

// Break-in-service focus management
const breakServiceYes = document.getElementById('break_service_yes');
const originalServiceStart = document.getElementById('original_service_start');

if (breakServiceYes && originalServiceStart) {
    breakServiceYes.addEventListener('change', function() {
        if (this.checked) {
            originalServiceStart.focus();
        }
    });
}

// Part-time service focus management
const partTimeYes = document.getElementById('part_time_yes');
const partTimeStart = document.getElementById('part_time_start');

if (partTimeYes && partTimeStart) {
    partTimeYes.addEventListener('change', function() {
        if (this.checked) {
            partTimeStart.focus();
        }
    });
}

// Date range validation - ensure "to" dates are after "from" dates
function validateDateRange(startId, endId, label) {
    const startInput = document.getElementById(startId);
    const endInput = document.getElementById(endId);
    
    if (startInput && endInput) {
        const validateDates = function() {
            const startDate = startInput.value;
            const endDate = endInput.value;
            
            if (startDate && endDate && endDate < startDate) {
                endInput.setCustomValidity(`End date must be after start date for ${label}`);
                endInput.style.borderColor = '#dc3545';
            } else {
                endInput.setCustomValidity('');
                endInput.style.borderColor = '';
            }
        };
        
        startInput.addEventListener('change', validateDates);
        endInput.addEventListener('change', validateDates);
    }
}

// Apply date range validation to all date ranges
validateDateRange('active_duty_start', 'active_duty_end', 'Active Duty service');
validateDateRange('reserve_start', 'reserve_end', 'Reserve service');
validateDateRange('academy_start', 'academy_end', 'Academy service');
validateDateRange('non_deduction_start', 'non_deduction_end', 'Non-Deduction service');
validateDateRange('original_service_start', 'original_service_end', 'Original service');
validateDateRange('break_service_start', 'break_service_end', 'Break-in-Service');
validateDateRange('part_time_start', 'part_time_end', 'Part-Time service');

// When "No to ALL" is checked, select "No" for all three military sections
if (noMilitaryCheckbox) {
    noMilitaryCheckbox.addEventListener('change', function() {
        if (this.checked) {
            if (activeDutyNo) activeDutyNo.checked = true;
            if (reserveNo) reserveNo.checked = true;
            if (academyNo) academyNo.checked = true;
        }
    });
}

// When any military service "Yes" is checked, uncheck "No to ALL"
const militaryYesButtons = [activeDutyYes, reserveYes, academyYes];
militaryYesButtons.forEach(button => {
    if (button) {
        button.addEventListener('change', function() {
            if (this.checked && noMilitaryCheckbox) {
                noMilitaryCheckbox.checked = false;
            }
        });
    }
});

// TSP Allocation Validation
const allocationInputs = [
    'tsp_g_allocation', 'tsp_f_allocation', 'tsp_c_allocation', 'tsp_s_allocation', 'tsp_i_allocation',
    'tsp_l_income_allocation', 'tsp_l2025_allocation', 'tsp_l2030_allocation', 'tsp_l2035_allocation',
    'tsp_l2040_allocation', 'tsp_l2045_allocation', 'tsp_l2050_allocation', 'tsp_l2055_allocation',
    'tsp_l2060_allocation', 'tsp_l2065_70_allocation'
];

const balanceInputs = [
    'tsp_g_balance', 'tsp_f_balance', 'tsp_c_balance', 'tsp_s_balance', 'tsp_i_balance',
    'tsp_l_income_balance', 'tsp_l2025_balance', 'tsp_l2030_balance', 'tsp_l2035_balance',
    'tsp_l2040_balance', 'tsp_l2045_balance', 'tsp_l2050_balance', 'tsp_l2055_balance',
    'tsp_l2060_balance', 'tsp_l2065_70_balance'
];

function calculateTSPTotals() {
    // Calculate allocation total
    let allocationTotal = 0;
    allocationInputs.forEach(name => {
        const input = document.querySelector(`input[name="${name}"]`);
        if (input && input.value) {
            allocationTotal += parseFloat(input.value) || 0;
        }
    });
    
    // Calculate balance total
    let balanceTotal = 0;
    balanceInputs.forEach(name => {
        const input = document.querySelector(`input[name="${name}"]`);
        if (input && input.value) {
            balanceTotal += parseFloat(input.value) || 0;
        }
    });
    
    // Update totals display
    const allocationTotalInput = document.getElementById('tsp_allocation_total');
    const balanceTotalInput = document.getElementById('tsp_balance_total');
    const errorRow = document.getElementById('allocation_error_row');
    const errorMessage = document.getElementById('allocation_error_message');
    
    if (allocationTotalInput) {
        allocationTotalInput.value = allocationTotal.toFixed(0);
        
        // Show error if total exceeds 100%
        if (allocationTotal > 100) {
            allocationTotalInput.style.background = '#f8d7da';
            allocationTotalInput.style.color = '#721c24';
            allocationTotalInput.style.fontWeight = 'bold';
            errorRow.style.display = 'table-row';
            errorMessage.textContent = `Total allocation is ${allocationTotal}%. The combined allocation across all TSP funds cannot exceed 100%.`;
        } else if (allocationTotal > 0 && allocationTotal < 100) {
            allocationTotalInput.style.background = '#fff3cd';
            allocationTotalInput.style.color = '#856404';
            allocationTotalInput.style.fontWeight = 'bold';
            errorRow.style.display = 'table-row';
            errorMessage.textContent = `Total allocation is ${allocationTotal}%. Consider allocating the remaining ${(100 - allocationTotal).toFixed(0)}% to reach 100%.`;
            errorRow.style.background = '#fff3cd';
            errorRow.querySelector('td').style.background = '#fff3cd';
            errorRow.querySelector('td').style.color = '#856404';
            errorRow.querySelector('td').style.borderColor = '#ffeaa7';
        } else {
            allocationTotalInput.style.background = '#e9ecef';
            allocationTotalInput.style.color = '#000';
            allocationTotalInput.style.fontWeight = 'normal';
            errorRow.style.display = 'none';
        }
    }
    
    if (balanceTotalInput) {
        balanceTotalInput.value = balanceTotal.toFixed(2);
    }
}

// Add event listeners to all allocation and balance inputs
allocationInputs.forEach(name => {
    const input = document.querySelector(`input[name="${name}"]`);
    if (input) {
        input.addEventListener('input', calculateTSPTotals);
        input.addEventListener('change', calculateTSPTotals);
    }
});

balanceInputs.forEach(name => {
    const input = document.querySelector(`input[name="${name}"]`);
    if (input) {
        input.addEventListener('input', calculateTSPTotals);
        input.addEventListener('change', calculateTSPTotals);
    }
});

// Comprehensive Form Validation
function validateForm() {
    let errors = [];
    
    // 1. Employee Name is required
    const employeeName = document.querySelector('input[name="employee_name"]');
    if (employeeName && !employeeName.value.trim()) {
        errors.push({
            field: 'Employee Name',
            message: 'Employee name is required and cannot be blank.',
            element: employeeName
        });
    }
    
    // 2. Validate all number inputs - must be valid numbers (no characters)
    const numberInputs = document.querySelectorAll('input[type="number"]');
    numberInputs.forEach(input => {
        if (input.value && input.value.trim() !== '') {
            const value = parseFloat(input.value);
            if (isNaN(value)) {
                const label = input.closest('.row, .form-group')?.querySelector('label')?.textContent || 
                             input.getAttribute('name')?.replace(/_/g, ' ') || 'Unknown field';
                errors.push({
                    field: label.trim(),
                    message: `"${label.trim()}" must be a valid number (no characters allowed).`,
                    element: input
                });
            }
            // Check if value is negative for fields with min="0"
            else if (input.hasAttribute('min') && value < parseFloat(input.getAttribute('min'))) {
                const label = input.closest('.row, .form-group')?.querySelector('label')?.textContent || 
                             input.getAttribute('name')?.replace(/_/g, ' ') || 'Unknown field';
                errors.push({
                    field: label.trim(),
                    message: `"${label.trim()}" cannot be negative.`,
                    element: input
                });
            }
        }
    });
    
    // 3. Validate text inputs that should contain numbers (sick leave, annual leave, etc.)
    const textNumberFields = [
        'sick_leave_balance',
        'annual_leave_balance'
    ];
    
    textNumberFields.forEach(fieldName => {
        const input = document.querySelector(`input[name="${fieldName}"]`);
        if (input && input.value && input.value.trim() !== '') {
            const value = parseFloat(input.value);
            if (isNaN(value)) {
                const label = input.closest('.row, .form-group')?.querySelector('label')?.textContent || 
                             fieldName.replace(/_/g, ' ');
                errors.push({
                    field: label.trim(),
                    message: `"${label.trim()}" must be a valid number (no characters allowed).`,
                    element: input
                });
            }
        }
    });
    
    // 4. TSP Allocation Total validation (already exists)
    let allocationTotal = 0;
    allocationInputs.forEach(name => {
        const input = document.querySelector(`input[name="${name}"]`);
        if (input && input.value) {
            allocationTotal += parseFloat(input.value) || 0;
        }
    });
    
    if (allocationTotal > 100) {
        errors.push({
            field: 'TSP Allocation Total',
            message: `TSP allocation total is ${allocationTotal}%. The combined allocation across all TSP funds cannot exceed 100%.`,
            element: document.querySelector('input[name="tsp_g_allocation"]')
        });
    }
    
    return errors;
}

// Validate on form submission
const factFinderForm = document.getElementById('factFinderForm');
if (factFinderForm) {
    factFinderForm.addEventListener('submit', function(event) {
        const errors = validateForm();
        
        if (errors.length > 0) {
            event.preventDefault();
            
            // Build error message
            let errorMessage = 'Please correct the following errors before submitting:\n\n';
            errors.forEach((error, index) => {
                errorMessage += `${index + 1}. ${error.message}\n`;
            });
            
            alert(errorMessage);
            
            // Scroll to first error field and highlight it
            if (errors[0].element) {
                errors[0].element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                errors[0].element.focus();
                errors[0].element.style.border = '2px solid #dc3545';
                
                // Remove highlight after 3 seconds
                setTimeout(() => {
                    errors[0].element.style.border = '';
                }, 3000);
            }
            
            return false;
        }
    });
}

// Calculate totals on page load
calculateTSPTotals();

// Initialize documents list
renderDocuments();
</script>
{% endblock %}
